<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ุชุณุฌูู ุจุฑูู ุงููุงุชู</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
</head>
<body style="direction: rtl; font-family: sans-serif; text-align: center; margin-top: 50px;">
  <h2>ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ุฑูู ุงููุงุชู</h2>
  <input type="text" id="phone" placeholder="ูุซูุงู: +201001234567"><br><br>

  <!-- ููุง ููุธูุฑ reCAPTCHA -->
  <div id="recaptcha-container"></div><br>

  <button onclick="sendOTP()">ุฅุฑุณุงู ุงูุฑูุฒ</button>

  <br><br>
  <input type="text" id="otp" placeholder="ุงุฏุฎู ุฑูุฒ ุงูุชุญูู"><br><br>
  <button onclick="verifyOTP()">ุชุฃููุฏ ุงูุฑูุฒ</button>

  <script>
    // ุฅุนุฏุงุฏ Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDpVbmJ_B6l6vycV7z2SmKYOe8zU8Ua88I",
      authDomain: "hossam-8a237.firebaseapp.com",
      projectId: "hossam-8a237",
      storageBucket: "hossam-8a237.firebasestorage.app",
      messagingSenderId: "308994128812",
      appId: "1:308994128812:web:f7c677b20b249f077ad809",
      measurementId: "G-1T7X1QSFZY"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    window.onload = function() {
      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(
        'recaptcha-container',
        {
          size: 'normal',
          callback: () => console.log('โ reCAPTCHA ุงุชูุนู'),
          'expired-callback': () => alert("ุงูุชูุช ุตูุงุญูุฉ reCAPTCHAุ ุฌุฑุจ ูุฑูุฉ ุซุงููุฉ")
        }
      );
      recaptchaVerifier.render().then(widgetId => window.recaptchaWidgetId = widgetId);
    };

    function sendOTP() {
      const phoneNumber = document.getElementById('phone').value;
      if (!phoneNumber.startsWith('+')) {
        return alert("โ ุฑูู ุงููุงุชู ูุงุฒู ูุจุฏุฃ ุจู + ูููุชุงุญ ุฏููุชูุ ุฒู: +20...");
      }
      auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
        .then(result => {
          window.confirmationResult = result;
          alert("๐ฉ ุฃุฑุณููุง ูู ุฑูุฒ ุนูู ุงูููุจุงูู!");
        })
        .catch(err => {
          console.error(err);
          alert("โ๏ธ ุฎุทุฃ: " + err.message);
          // ูู ุชุญุจ ูููู ุฃุถูู

        });
    }

    function verifyOTP() {
      const code = document.getElementById('otp').value.trim();
      if (code==='') return alert("ุงูุชุจ ุฑูุฒ ุงูุชุญูู ุฃู OTP");
      window.confirmationResult.confirm(code)
        .then(() => alert("โ ุงูOTP ุตุญ! ุฏุฎูุช ุจูุฌุงุญ"))
        .catch(() => alert("โ ุงูุฑูุฒ ุฎุทุฃ ุฃู ููุชูู."));
    }
  </script>
</body>
</html>
